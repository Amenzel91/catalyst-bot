============================= test session starts =============================
platform win32 -- Python 3.13.7, pytest-8.4.2, pluggy-1.6.0 -- C:\Python313\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\menza\OneDrive\Desktop\Catalyst-Bot\catalyst-bot
configfile: pyproject.toml
plugins: mock-3.15.1
collecting ... collected 361 items

tests/test_admin_controls.py::TestReportGeneration::test_generate_admin_report_basic PASSED [  0%]
tests/test_admin_controls.py::TestReportGeneration::test_generate_admin_report_no_data PASSED [  0%]
tests/test_admin_controls.py::TestReportGeneration::test_generate_admin_report_with_feedback_data PASSED [  0%]
tests/test_admin_controls.py::TestKeywordAnalysis::test_keyword_performance_calculation PASSED [  1%]
tests/test_admin_controls.py::TestKeywordAnalysis::test_keyword_weight_adjustment_up PASSED [  1%]
tests/test_admin_controls.py::TestKeywordAnalysis::test_keyword_weight_adjustment_down PASSED [  1%]
tests/test_admin_controls.py::TestKeywordAnalysis::test_keyword_weight_no_change PASSED [  1%]
tests/test_admin_controls.py::TestParameterRecommendations::test_min_score_recommendation_low_hit_rate PASSED [  2%]
tests/test_admin_controls.py::TestParameterRecommendations::test_price_ceiling_recommendation_negative_returns PASSED [  2%]
tests/test_admin_controls.py::TestParameterRecommendations::test_confidence_threshold_recommendation_low_sharpe PASSED [  2%]
tests/test_admin_controls.py::TestDiscordEmbed::test_build_admin_embed_basic PASSED [  3%]
tests/test_admin_controls.py::TestDiscordEmbed::test_build_admin_embed_performance_field PASSED [  3%]
tests/test_admin_controls.py::TestDiscordEmbed::test_build_admin_embed_recommendations_field PASSED [  3%]
tests/test_admin_controls.py::TestDiscordEmbed::test_build_admin_embed_color_logic PASSED [  3%]
tests/test_admin_controls.py::TestDiscordComponents::test_build_admin_components_structure PASSED [  4%]
tests/test_admin_controls.py::TestDiscordComponents::test_build_admin_components_button_ids PASSED [  4%]
tests/test_admin_controls.py::TestDiscordComponents::test_build_admin_components_button_styles PASSED [  4%]
tests/test_admin_controls.py::TestReportPersistence::test_save_admin_report PASSED [  4%]
tests/test_admin_controls.py::TestReportPersistence::test_load_admin_report PASSED [  5%]
tests/test_admin_controls.py::TestReportPersistence::test_load_nonexistent_report PASSED [  5%]
tests/test_admin_controls.py::TestIntegration::test_full_report_lifecycle PASSED [  5%]
tests/test_admin_controls.py::TestIntegration::test_backtest_with_price_data PASSED [  6%]
tests/test_admin_controls.py::TestEdgeCases::test_empty_backtest_summary PASSED [  6%]
tests/test_admin_controls.py::TestEdgeCases::test_malformed_events_file PASSED [  6%]
tests/test_admin_controls.py::TestEdgeCases::test_missing_keyword_weights_file PASSED [  6%]
tests/test_admin_controls.py::TestButtonHandlers::test_handle_view_details_button PASSED [  7%]
tests/test_admin_controls.py::TestButtonHandlers::test_handle_approve_button PASSED [  7%]
tests/test_admin_controls.py::TestButtonHandlers::test_handle_reject_button PASSED [  7%]
tests/test_admin_controls.py::TestButtonHandlers::test_handle_custom_modal_button PASSED [  8%]
tests/test_admin_controls.py::TestButtonHandlers::test_handle_modal_submission PASSED [  8%]
tests/test_admin_controls.py::TestButtonHandlerEdgeCases::test_view_details_nonexistent_report PASSED [  8%]
tests/test_admin_controls.py::TestButtonHandlerEdgeCases::test_approve_nonexistent_report PASSED [  8%]
tests/test_admin_controls.py::TestButtonHandlerEdgeCases::test_invalid_button_custom_id PASSED [  9%]
tests/test_admin_controls.py::TestButtonHandlerEdgeCases::test_malformed_custom_id PASSED [  9%]
tests/test_admin_controls.py::TestButtonHandlerEdgeCases::test_modal_submission_empty_values PASSED [  9%]
tests/test_admin_controls.py::TestButtonHandlerEdgeCases::test_modal_submission_invalid_values PASSED [  9%]
tests/test_admin_controls.py::TestApprovalFlowIntegration::test_full_approval_workflow PASSED [ 10%]
tests/test_admin_controls.py::TestApprovalFlowIntegration::test_approval_then_rollback_workflow PASSED [ 10%]
tests/test_admin_summary_embed.py::test_post_admin_summary_md_noop_without_flag PASSED [ 10%]
tests/test_admin_summary_embed.py::test_post_admin_summary_md_path_missing_returns_false PASSED [ 11%]
tests/test_ai_adapter_integration.py::test_ai_adapter_mock_enriches_tags_and_sentiment PASSED [ 11%]
tests/test_alerts_indicators_embed.py::test_enrich_with_indicators_appends_fields PASSED [ 11%]
tests/test_alerts_indicators_embed.py::test_enrich_with_indicators_noop_on_none PASSED [ 11%]
tests/test_analyst_signals.py::test_get_analyst_signal_classification PASSED [ 12%]
tests/test_analyst_signals.py::test_get_analyst_signal_disabled PASSED   [ 12%]
tests/test_analyzer_helpers.py::test_write_markdown_report PASSED        [ 12%]
tests/test_analyzer_helpers.py::test_write_pending_changes PASSED        [ 13%]
tests/test_backtest_metrics_cli.py::test_metrics_summary_basic PASSED    [ 13%]
tests/test_backtest_provider_chain.py::test_backtest_provider_prefers_tiingo PASSED [ 13%]
tests/test_backtest_provider_chain.py::test_backtest_provider_falls_back_to_av PASSED [ 13%]
tests/test_backtest_provider_chain.py::test_backtest_provider_uses_yfinance PASSED [ 14%]
tests/test_backtest_simulator_basic.py::test_simulator_converts_events_and_runs PASSED [ 14%]
tests/test_backtesting.py::TestTradeSimulator::test_simulator_initialization PASSED [ 14%]
tests/test_backtesting.py::TestTradeSimulator::test_slippage_calculation_fixed PASSED [ 14%]
tests/test_backtesting.py::TestTradeSimulator::test_slippage_calculation_adaptive PASSED [ 15%]
tests/test_backtesting.py::TestTradeSimulator::test_volume_constraints PASSED [ 15%]
tests/test_backtesting.py::TestTradeSimulator::test_trade_execution_buy PASSED [ 15%]
tests/test_backtesting.py::TestTradeSimulator::test_trade_execution_insufficient_capital PASSED [ 16%]
tests/test_backtesting.py::TestPortfolio::test_portfolio_initialization PASSED [ 16%]
tests/test_backtesting.py::TestPortfolio::test_open_position PASSED      [ 16%]
tests/test_backtesting.py::TestPortfolio::test_close_position PASSED     [ 16%]
tests/test_backtesting.py::TestPortfolio::test_performance_metrics PASSED [ 17%]
tests/test_backtesting.py::TestAnalytics::test_sharpe_ratio PASSED       [ 17%]
tests/test_backtesting.py::TestAnalytics::test_max_drawdown PASSED       [ 17%]
tests/test_backtesting.py::TestAnalytics::test_win_rate PASSED           [ 18%]
tests/test_backtesting.py::TestAnalytics::test_profit_factor PASSED      [ 18%]
tests/test_backtesting.py::TestBacktestEngine::test_engine_initialization PASSED [ 18%]
tests/test_backtesting.py::TestBacktestEngine::test_entry_strategy PASSED [ 18%]
tests/test_backtesting.py::TestBacktestEngine::test_exit_strategy PASSED [ 19%]
tests/test_backtesting.py::TestReports::test_markdown_report_generation PASSED [ 19%]
tests/test_backtesting.py::TestReports::test_json_report_generation PASSED [ 19%]
tests/test_backtesting.py::TestReports::test_export_trades_csv PASSED    [ 19%]
tests/test_backtesting.py::TestValidator::test_validation_recommendation PASSED [ 20%]
tests/test_backtesting.py::TestMonte\u0421arlo::test_random_walk_simulation PASSED [ 20%]
tests/test_backtesting.py::TestMonte\u0421arlo::test_parameter_sweep_structure PASSED [ 20%]
tests/test_chart_guard.py::test_charts_import_guard_present PASSED       [ 21%]
tests/test_classify.py::test_classify_detects_fda_keyword_and_sentiment PASSED [ 21%]
tests/test_classify.py::test_classify_bridge_min_contract PASSED         [ 21%]
tests/test_db_integrity.py::test_unique_keys PASSED                      [ 21%]
tests/test_dedupe.py::test_dedupe_stable PASSED                          [ 22%]
tests/test_dummy_alert_embed.py::test_dummy_alert_embed_features PASSED  [ 22%]
tests/test_earnings_integration.py::test_earnings_sentiment_aggregation PASSED [ 22%]
tests/test_false_positive_tracker.py::TestAcceptedItemsLogger::test_log_accepted_item PASSED [ 22%]
tests/test_false_positive_tracker.py::TestAcceptedItemsLogger::test_log_accepted_item_no_ticker PASSED [ 23%]
tests/test_false_positive_tracker.py::TestOutcomeClassification::test_classify_success_1h PASSED [ 23%]
tests/test_false_positive_tracker.py::TestOutcomeClassification::test_classify_success_4h PASSED [ 23%]
tests/test_false_positive_tracker.py::TestOutcomeClassification::test_classify_success_1d PASSED [ 24%]
tests/test_false_positive_tracker.py::TestOutcomeClassification::test_classify_failure_negative PASSED [ 24%]
tests/test_false_positive_tracker.py::TestOutcomeClassification::test_classify_failure_minimal PASSED [ 24%]
tests/test_false_positive_tracker.py::TestOutcomeClassification::test_classify_failure_borderline PASSED [ 24%]
tests/test_false_positive_tracker.py::TestPatternAnalysis::test_calculate_precision_recall PASSED [ 25%]
tests/test_false_positive_tracker.py::TestPatternAnalysis::test_analyze_keyword_patterns PASSED [ 25%]
tests/test_false_positive_tracker.py::TestPatternAnalysis::test_analyze_source_patterns PASSED [ 25%]
tests/test_false_positive_tracker.py::TestPatternAnalysis::test_generate_keyword_penalties PASSED [ 26%]
tests/test_false_positive_tracker.py::TestIntegration::test_end_to_end_workflow PASSED [ 26%]
tests/test_feeds_price_ceiling_and_context.py::test_price_ceiling_enrichment_and_intraday PASSED [ 26%]
tests/test_fmp_sentiment.py::test_attach_fmp_sentiment_simple PASSED     [ 26%]
tests/test_fmp_sentiment.py::test_fetch_fmp_sentiment_parses_sample PASSED [ 27%]
tests/test_fundamental_scoring.py::TestFloatSharesScoring::test_very_low_float PASSED [ 27%]
tests/test_fundamental_scoring.py::TestFloatSharesScoring::test_low_float PASSED [ 27%]
tests/test_fundamental_scoring.py::TestFloatSharesScoring::test_medium_float PASSED [ 27%]
tests/test_fundamental_scoring.py::TestFloatSharesScoring::test_high_float PASSED [ 28%]
tests/test_fundamental_scoring.py::TestFloatSharesScoring::test_boundary_cases PASSED [ 28%]
tests/test_fundamental_scoring.py::TestShortInterestScoring::test_very_high_si PASSED [ 28%]
tests/test_fundamental_scoring.py::TestShortInterestScoring::test_high_si PASSED [ 29%]
tests/test_fundamental_scoring.py::TestShortInterestScoring::test_moderate_si PASSED [ 29%]
tests/test_fundamental_scoring.py::TestShortInterestScoring::test_low_si PASSED [ 29%]
tests/test_fundamental_scoring.py::TestShortInterestScoring::test_boundary_cases PASSED [ 29%]
tests/test_fundamental_scoring.py::TestFundamentalScoreCalculation::test_feature_disabled PASSED [ 30%]
tests/test_fundamental_scoring.py::TestFundamentalScoreCalculation::test_both_factors_available PASSED [ 30%]
tests/test_fundamental_scoring.py::TestFundamentalScoreCalculation::test_only_float_available PASSED [ 30%]
tests/test_fundamental_scoring.py::TestFundamentalScoreCalculation::test_only_si_available PASSED [ 31%]
tests/test_fundamental_scoring.py::TestFundamentalScoreCalculation::test_no_data_available PASSED [ 31%]
tests/test_fundamental_scoring.py::TestFundamentalScoreCalculation::test_invalid_ticker PASSED [ 31%]
tests/test_fundamental_scoring.py::TestFundamentalScoreCalculation::test_fetch_error_handling PASSED [ 31%]
tests/test_fundamental_scoring.py::TestFeatureFlagCheck::test_enabled PASSED [ 32%]
tests/test_fundamental_scoring.py::TestFeatureFlagCheck::test_disabled PASSED [ 32%]
tests/test_fundamental_scoring.py::TestFeatureFlagCheck::test_default_disabled PASSED [ 32%]
tests/test_fundamental_scoring.py::TestClassificationIntegration::test_classification_with_fundamental_boost PASSED [ 32%]
tests/test_fundamental_scoring.py::TestClassificationIntegration::test_classification_with_feature_disabled PASSED [ 33%]
tests/test_fundamental_scoring.py::TestClassificationIntegration::test_classification_without_ticker PASSED [ 33%]
tests/test_fundamental_scoring.py::TestClassificationIntegration::test_classification_handles_fundamental_errors PASSED [ 33%]
tests/test_fundamental_scoring.py::TestRealWorldScenarios::test_low_float_squeeze_candidate PASSED [ 34%]
tests/test_fundamental_scoring.py::TestRealWorldScenarios::test_meme_stock_characteristics PASSED [ 34%]
tests/test_fundamental_scoring.py::TestRealWorldScenarios::test_large_cap_stock PASSED [ 34%]
tests/test_historical_bootstrapper.py::TestHistoricalBootstrapperInit::test_init_dates PASSED [ 34%]
tests/test_historical_bootstrapper.py::TestHistoricalBootstrapperInit::test_init_stats PASSED [ 35%]
tests/test_historical_bootstrapper.py::TestSECFeedFetching::test_fetch_sec_historical_success PASSED [ 35%]
tests/test_historical_bootstrapper.py::TestSECFeedFetching::test_fetch_sec_historical_http_error PASSED [ 35%]
tests/test_historical_bootstrapper.py::TestSECFeedFetching::test_fetch_sec_historical_invalid_source PASSED [ 36%]
tests/test_historical_bootstrapper.py::TestClassificationSimulation::test_simulate_rejection_low_score PASSED [ 36%]
tests/test_historical_bootstrapper.py::TestClassificationSimulation::test_simulate_rejection_high_price PASSED [ 36%]
tests/test_historical_bootstrapper.py::TestClassificationSimulation::test_simulate_rejection_low_price PASSED [ 36%]
tests/test_historical_bootstrapper.py::TestClassificationSimulation::test_simulate_rejection_passes PASSED [ 37%]
tests/test_historical_bootstrapper.py::TestSmartTimeframeSelection::test_get_available_timeframes_recent PASSED [ 37%]
tests/test_historical_bootstrapper.py::TestSmartTimeframeSelection::test_get_available_timeframes_old FAILED [ 37%]
tests/test_historical_bootstrapper.py::TestCheckpointSystem::test_save_checkpoint PASSED [ 37%]
tests/test_historical_bootstrapper.py::TestCheckpointSystem::test_load_checkpoint PASSED [ 38%]
tests/test_historical_bootstrapper.py::TestCheckpointSystem::test_load_checkpoint_missing PASSED [ 38%]
tests/test_historical_bootstrapper.py::TestCheckpointSystem::test_load_checkpoint_corrupted PASSED [ 38%]
tests/test_historical_bootstrapper.py::TestHistoricalPriceFetching::test_get_historical_price_success PASSED [ 39%]
tests/test_historical_bootstrapper.py::TestHistoricalPriceFetching::test_get_historical_price_no_data PASSED [ 39%]
tests/test_historical_bootstrapper.py::TestHistoricalPriceFetching::test_get_historical_price_exception PASSED [ 39%]
tests/test_historical_bootstrapper.py::TestOutcomeFetching::test_fetch_outcome_for_timeframe_1d PASSED [ 39%]
tests/test_historical_bootstrapper.py::TestOutcomeFetching::test_fetch_outcome_for_timeframe_future PASSED [ 40%]
tests/test_historical_bootstrapper.py::TestDataWriting::test_log_rejected_item PASSED [ 40%]
tests/test_historical_bootstrapper.py::TestEndToEnd::test_run_full_month PASSED [ 40%]
tests/test_historical_bootstrapper.py::test_timeframes_definition PASSED [ 40%]
tests/test_historical_bootstrapper.py::test_sec_feed_urls PASSED         [ 41%]
tests/test_historical_bootstrapper.py::TestVolumeDataCollection::test_volume_field_populated PASSED [ 41%]
tests/test_historical_bootstrapper.py::TestVolumeDataCollection::test_avg_volume_20d_calculation PASSED [ 41%]
tests/test_historical_bootstrapper.py::TestVolumeDataCollection::test_relative_volume_calculation PASSED [ 42%]
tests/test_historical_bootstrapper.py::TestVolumeDataCollection::test_volume_data_edge_case_less_than_20_days PASSED [ 42%]
tests/test_historical_bootstrapper.py::TestIntradayPriceCollection::test_open_high_low_fields_populated PASSED [ 42%]
tests/test_historical_bootstrapper.py::TestIntradayPriceCollection::test_high_return_pct_calculation PASSED [ 42%]
tests/test_historical_bootstrapper.py::TestIntradayPriceCollection::test_low_return_pct_calculation PASSED [ 43%]
tests/test_historical_bootstrapper.py::TestIntradayPriceCollection::test_close_field_replaces_price PASSED [ 43%]
tests/test_historical_bootstrapper.py::TestPreEventContext::test_prices_1d_7d_30d_before_fetched PASSED [ 43%]
tests/test_historical_bootstrapper.py::TestPreEventContext::test_momentum_calculations PASSED [ 44%]
tests/test_historical_bootstrapper.py::TestPreEventContext::test_ipo_stock_no_historical_data PASSED [ 44%]
tests/test_historical_bootstrapper.py::TestMarketContext::test_spy_returns_fetched PASSED [ 44%]
tests/test_historical_bootstrapper.py::TestMarketContext::test_spy_data_cached PASSED [ 44%]
tests/test_historical_bootstrapper.py::TestMarketContext::test_market_closed_days_handling PASSED [ 45%]
tests/test_historical_bootstrapper.py::TestOutcomeDataIntegration::test_fetch_and_log_outcomes_includes_all_enhancements FAILED [ 45%]
tests/test_llm_gpu_warmup.py::TestGPUWarmup::test_warmup_state_initially_false PASSED [ 45%]
tests/test_llm_gpu_warmup.py::TestGPUWarmup::test_successful_warmup PASSED [ 45%]
tests/test_llm_gpu_warmup.py::TestGPUWarmup::test_warmup_skips_if_already_warmed PASSED [ 46%]
tests/test_llm_gpu_warmup.py::TestGPUWarmup::test_warmup_force_overwrites_state PASSED [ 46%]
tests/test_llm_gpu_warmup.py::TestGPUWarmup::test_warmup_failure PASSED  [ 46%]
tests/test_llm_gpu_warmup.py::TestGPUWarmup::test_warmup_exception_handling PASSED [ 47%]
tests/test_llm_gpu_warmup.py::TestGPUWarmup::test_warmup_max_attempts PASSED [ 47%]
tests/test_llm_gpu_warmup.py::TestGPUWarmup::test_reset_warmup_state PASSED [ 47%]
tests/test_llm_gpu_warmup.py::TestGPUMemoryStats::test_memory_stats_unavailable_without_torch PASSED [ 47%]
tests/test_llm_gpu_warmup.py::TestGPUMemoryStats::test_memory_stats_unavailable_without_cuda PASSED [ 48%]
tests/test_llm_gpu_warmup.py::TestGPUMemoryStats::test_memory_stats_returns_correct_format PASSED [ 48%]
tests/test_llm_gpu_warmup.py::TestGPUMemoryStats::test_memory_stats_handles_errors PASSED [ 48%]
tests/test_llm_gpu_warmup.py::TestGPUMemoryCleanup::test_cleanup_skips_without_torch PASSED [ 49%]
tests/test_llm_gpu_warmup.py::TestGPUMemoryCleanup::test_cleanup_executes_sequence PASSED [ 49%]
tests/test_llm_gpu_warmup.py::TestGPUMemoryCleanup::test_cleanup_respects_interval PASSED [ 49%]
tests/test_llm_gpu_warmup.py::TestGPUMemoryCleanup::test_cleanup_handles_errors PASSED [ 49%]
tests/test_llm_gpu_warmup.py::TestIntegration::test_warmup_with_memory_monitoring PASSED [ 50%]
tests/test_llm_gpu_warmup.py::TestIntegration::test_warmup_with_cleanup PASSED [ 50%]
tests/test_llm_stability.py::TestRateLimiter::test_rate_limiter_creation PASSED [ 50%]
tests/test_llm_stability.py::TestRateLimiter::test_rate_limiter_allows_first_request PASSED [ 50%]
tests/test_llm_stability.py::TestRateLimiter::test_rate_limiter_enforces_min_interval PASSED [ 51%]
tests/test_llm_stability.py::TestRateLimiter::test_rate_limiter_enforces_per_minute_limit PASSED [ 51%]
tests/test_llm_stability.py::TestRateLimiter::test_rate_limiter_exponential_backoff PASSED [ 51%]
tests/test_llm_stability.py::TestRateLimiter::test_rate_limiter_resets_on_success PASSED [ 52%]
tests/test_llm_stability.py::TestRateLimiter::test_rate_limiter_stats PASSED [ 52%]
tests/test_llm_stability.py::TestRateLimiter::test_rate_limiter_wait_if_needed FAILED [ 52%]
tests/test_llm_stability.py::TestBatchProcessor::test_batch_processor_creation PASSED [ 52%]
tests/test_llm_stability.py::TestBatchProcessor::test_batch_processor_pre_filter PASSED [ 53%]
tests/test_llm_stability.py::TestBatchProcessor::test_batch_processor_no_filter_when_threshold_zero PASSED [ 53%]
tests/test_llm_stability.py::TestBatchProcessor::test_batch_processor_processes_in_batches FAILED [ 53%]
tests/test_llm_stability.py::TestBatchProcessor::test_batch_processor_handles_errors_gracefully FAILED [ 54%]
tests/test_llm_stability.py::TestErrorHandler::test_error_handler_creation PASSED [ 54%]
tests/test_llm_stability.py::TestErrorHandler::test_error_handler_records_errors PASSED [ 54%]
tests/test_llm_stability.py::TestErrorHandler::test_error_handler_should_retry PASSED [ 54%]
tests/test_llm_stability.py::TestErrorHandler::test_error_handler_stats PASSED [ 55%]
tests/test_llm_stability.py::TestGlobalInstances::test_get_rate_limiter_creates_instance PASSED [ 55%]
tests/test_llm_stability.py::TestGlobalInstances::test_get_error_handler_returns_singleton PASSED [ 55%]
tests/test_llm_stability.py::TestGlobalInstances::test_get_batch_processor_creates_configured_instance PASSED [ 55%]
tests/test_llm_stability.py::TestIntegration::test_batch_processing_with_rate_limiting FAILED [ 56%]
tests/test_llm_stability.py::TestIntegration::test_batch_processing_with_error_recovery FAILED [ 56%]
tests/test_market_fallback.py::test_alpha_primary_short_circuits_yf PASSED [ 56%]
tests/test_market_fallback.py::test_yfinance_fallback_when_alpha_none PASSED [ 57%]
tests/test_market_fallback.py::test_yfinance_history_fallback_when_fast_info_partial PASSED [ 57%]
tests/test_market_intraday_snapshots.py::test_get_intraday_snapshots_segments PASSED [ 57%]
tests/test_market_volatility.py::test_get_volatility_averages_daily_ranges PASSED [ 57%]
tests/test_moa_analyzer.py::test_read_rejected_items_success PASSED      [ 58%]
tests/test_moa_analyzer.py::test_read_rejected_items_empty_file PASSED   [ 58%]
tests/test_moa_analyzer.py::test_read_rejected_items_missing_file PASSED [ 58%]
tests/test_moa_analyzer.py::test_read_rejected_items_malformed_data PASSED [ 59%]
tests/test_moa_analyzer.py::test_parse_outcomes_success PASSED           [ 59%]
tests/test_moa_analyzer.py::test_parse_outcomes_empty_file PASSED        [ 59%]
tests/test_moa_analyzer.py::test_calculate_keyword_frequencies PASSED    [ 59%]
tests/test_moa_analyzer.py::test_calculate_keyword_frequencies_multiple_occurrences PASSED [ 60%]
tests/test_moa_analyzer.py::test_identify_missed_opportunities_above_threshold PASSED [ 60%]
tests/test_moa_analyzer.py::test_identify_missed_opportunities_none_above_threshold PASSED [ 60%]
tests/test_moa_analyzer.py::test_generate_recommendations_new_keywords PASSED [ 60%]
tests/test_moa_analyzer.py::test_generate_recommendations_weight_adjustments PASSED [ 61%]
tests/test_moa_analyzer.py::test_statistical_significance_filtering_below_min PASSED [ 61%]
tests/test_moa_analyzer.py::test_statistical_significance_filtering_at_min PASSED [ 61%]
tests/test_moa_analyzer.py::test_save_recommendations_output PASSED      [ 62%]
tests/test_moa_analyzer.py::test_handling_missing_keywords_field PASSED  [ 62%]
tests/test_moa_analyzer.py::test_handling_empty_keywords_list PASSED     [ 62%]
tests/test_moa_analyzer.py::test_confidence_score_calculation PASSED     [ 62%]
tests/test_moa_analyzer.py::test_multiple_keywords_per_item PASSED       [ 63%]
tests/test_moa_analyzer.py::test_recommendations_include_timestamp PASSED [ 63%]
tests/test_moa_price_tracker.py::test_get_pending_items_1h_timeframe PASSED [ 63%]
tests/test_moa_price_tracker.py::test_get_pending_items_4h_timeframe PASSED [ 63%]
tests/test_moa_price_tracker.py::test_get_pending_items_24h_timeframe PASSED [ 64%]
tests/test_moa_price_tracker.py::test_get_pending_items_1w_timeframe PASSED [ 64%]
tests/test_moa_price_tracker.py::test_record_outcome_success PASSED      [ 64%]
tests/test_moa_price_tracker.py::test_record_outcome_appends_to_file PASSED [ 65%]
tests/test_moa_price_tracker.py::test_record_outcome_multiple_appends PASSED [ 65%]
tests/test_moa_price_tracker.py::test_is_missed_opportunity_true PASSED  [ 65%]
tests/test_moa_price_tracker.py::test_is_missed_opportunity_false PASSED [ 65%]
tests/test_moa_price_tracker.py::test_is_missed_opportunity_at_threshold PASSED [ 66%]
tests/test_moa_price_tracker.py::test_calculate_time_elapsed PASSED      [ 66%]
tests/test_moa_price_tracker.py::test_calculate_time_elapsed_fractional PASSED [ 66%]
tests/test_moa_price_tracker.py::test_market_hours_during_trading PASSED [ 67%]
tests/test_moa_price_tracker.py::test_market_hours_before_open PASSED    [ 67%]
tests/test_moa_price_tracker.py::test_market_hours_after_close PASSED    [ 67%]
tests/test_moa_price_tracker.py::test_market_hours_weekend PASSED        [ 67%]
tests/test_moa_price_tracker.py::test_rate_limiting_applied PASSED       [ 68%]
tests/test_moa_price_tracker.py::test_handling_missing_ticker PASSED     [ 68%]
tests/test_moa_price_tracker.py::test_handling_delisted_ticker PASSED    [ 68%]
tests/test_moa_price_tracker.py::test_handling_zero_price PASSED         [ 68%]
tests/test_moa_price_tracker.py::test_outcome_includes_keywords PASSED   [ 69%]
tests/test_moa_price_tracker.py::test_outcome_includes_rejection_reason PASSED [ 69%]
tests/test_moa_price_tracker.py::test_should_track_now_intraday_market_hours PASSED [ 69%]
tests/test_moa_price_tracker.py::test_should_track_now_intraday_closed PASSED [ 70%]
tests/test_moa_price_tracker.py::test_should_track_now_daily_anytime PASSED [ 70%]
tests/test_moa_price_tracker.py::test_already_tracked_prevents_duplicates PASSED [ 70%]
tests/test_moa_price_tracker.py::test_negative_price_change PASSED       [ 70%]
tests/test_moa_price_tracker.py::test_fetch_intraday_price_15m PASSED    [ 71%]
tests/test_moa_price_tracker.py::test_fetch_intraday_price_30m PASSED    [ 71%]
tests/test_moa_price_tracker.py::test_fetch_intraday_price_old_data PASSED [ 71%]
tests/test_moa_price_tracker.py::test_fetch_intraday_price_invalid_ticker PASSED [ 72%]
tests/test_moa_price_tracker.py::test_record_outcome_15m_timeframe PASSED [ 72%]
tests/test_moa_price_tracker.py::test_record_outcome_30m_timeframe PASSED [ 72%]
tests/test_moa_price_tracker.py::test_get_pending_items_15m_timeframe PASSED [ 72%]
tests/test_moa_price_tracker.py::test_get_pending_items_30m_timeframe PASSED [ 73%]
tests/test_prompt_compression.py::test_estimate_tokens_basic PASSED      [ 73%]
tests/test_prompt_compression.py::test_estimate_tokens_long PASSED       [ 73%]
tests/test_prompt_compression.py::test_should_compress_threshold PASSED  [ 73%]
tests/test_prompt_compression.py::test_extract_key_sections_empty PASSED [ 74%]
tests/test_prompt_compression.py::test_extract_key_sections_8k_filing PASSED [ 74%]
tests/test_prompt_compression.py::test_extract_key_sections_with_tables PASSED [ 74%]
tests/test_prompt_compression.py::test_extract_key_sections_with_bullets PASSED [ 75%]
tests/test_prompt_compression.py::test_prioritize_sections_under_budget PASSED [ 75%]
tests/test_prompt_compression.py::test_prioritize_sections_tight_budget PASSED [ 75%]
tests/test_prompt_compression.py::test_prioritize_sections_order PASSED  [ 75%]
tests/test_prompt_compression.py::test_compress_sec_filing_empty PASSED  [ 76%]
tests/test_prompt_compression.py::test_compress_sec_filing_short_text PASSED [ 76%]
tests/test_prompt_compression.py::test_compress_sec_filing_8k_sample PASSED [ 76%]
tests/test_prompt_compression.py::test_compress_sec_filing_achieves_target_ratio PASSED [ 77%]
tests/test_prompt_compression.py::test_compress_sec_filing_metadata PASSED [ 77%]
tests/test_prompt_compression.py::test_compress_sec_filing_different_budgets PASSED [ 77%]
tests/test_prompt_compression.py::test_compress_sec_filing_preserves_critical_info PASSED [ 77%]
tests/test_prompt_compression.py::test_compress_sec_filing_removes_boilerplate PASSED [ 78%]
tests/test_prompt_compression.py::test_compression_performance PASSED    [ 78%]
tests/test_prompt_compression.py::test_compression_ratio_calculation PASSED [ 78%]
tests/test_prompt_compression.py::test_sections_included_tracking PASSED [ 78%]
tests/test_prompt_compression.py::test_end_to_end_compression_workflow PASSED [ 79%]
tests/test_rejected_items_logger.py::TestSentimentBreakdownLogging::test_sentiment_breakdown_dict_populated PASSED [ 79%]
tests/test_rejected_items_logger.py::TestSentimentBreakdownLogging::test_sentiment_confidence_tracked PASSED [ 79%]
tests/test_rejected_items_logger.py::TestSentimentBreakdownLogging::test_sentiment_sources_used_tracking PASSED [ 80%]
tests/test_rejected_items_logger.py::TestSentimentBreakdownLogging::test_partial_sentiment_data_only_vader PASSED [ 80%]
tests/test_rejected_items_logger.py::TestSentimentBreakdownLogging::test_partial_sentiment_data_vader_and_ml PASSED [ 80%]
tests/test_rejected_items_logger.py::TestSentimentBreakdownLogging::test_backward_compatibility_no_raw_field PASSED [ 80%]
tests/test_rejected_items_logger.py::TestSentimentBreakdownLogging::test_backward_compatibility_empty_raw_field PASSED [ 81%]
tests/test_rejected_items_logger.py::TestSentimentBreakdownLogging::test_all_sentiment_sources_available PASSED [ 81%]
tests/test_rejected_items_logger.py::TestPriceRangeFiltering::test_should_log_within_range PASSED [ 81%]
tests/test_rejected_items_logger.py::TestPriceRangeFiltering::test_should_not_log_below_floor PASSED [ 81%]
tests/test_rejected_items_logger.py::TestPriceRangeFiltering::test_should_not_log_above_ceiling PASSED [ 82%]
tests/test_rejected_items_logger.py::TestPriceRangeFiltering::test_should_not_log_none_price PASSED [ 82%]
tests/test_rejected_items_logger.py::TestPriceRangeFiltering::test_log_rejected_item_filters_high_price PASSED [ 82%]
tests/test_rejected_items_logger.py::TestPriceRangeFiltering::test_log_rejected_item_filters_low_price PASSED [ 83%]
tests/test_rejected_items_logger.py::TestRejectionStats::test_get_rejection_stats_today PASSED [ 83%]
tests/test_rejected_items_logger.py::TestRejectionStats::test_get_rejection_stats_empty_file PASSED [ 83%]
tests/test_rejected_items_logger.py::TestRejectionStats::test_get_rejection_stats_missing_file PASSED [ 83%]
tests/test_rejected_items_logger.py::TestClearOldRejectedItems::test_clear_old_items_removes_old_entries PASSED [ 84%]
tests/test_rejected_items_logger.py::TestClearOldRejectedItems::test_clear_old_items_missing_file PASSED [ 84%]
tests/test_runner.py::test_runner_once_completes_without_errors PASSED   [ 84%]
tests/test_rvol.py::TestRVOLCalculation::test_calculate_rvol_basic PASSED [ 85%]
tests/test_rvol.py::TestRVOLCalculation::test_calculate_rvol_high_volume PASSED [ 85%]
tests/test_rvol.py::TestRVOLCalculation::test_calculate_rvol_low_volume PASSED [ 85%]
tests/test_rvol.py::TestRVOLCalculation::test_calculate_rvol_moderate_volume PASSED [ 85%]
tests/test_rvol.py::TestRVOLCalculation::test_calculate_rvol_insufficient_data PASSED [ 86%]
tests/test_rvol.py::TestRVOLCalculation::test_calculate_rvol_no_data PASSED [ 86%]
tests/test_rvol.py::TestRVOLCalculation::test_calculate_rvol_zero_volume PASSED [ 86%]
tests/test_rvol.py::TestRVOLCaching::test_cache_hit PASSED               [ 86%]
tests/test_rvol.py::TestRVOLCaching::test_cache_disabled PASSED          [ 87%]
tests/test_rvol.py::TestRVOLCaching::test_cache_stats PASSED             [ 87%]
tests/test_rvol.py::TestBulkRVOL::test_bulk_calculate_rvol PASSED        [ 87%]
tests/test_rvol.py::TestBulkRVOL::test_bulk_calculate_empty_list PASSED  [ 88%]
tests/test_rvol.py::TestBulkRVOL::test_bulk_calculate_partial_failure PASSED [ 88%]
tests/test_rvol.py::TestRVOLEdgeCases::test_invalid_ticker_format PASSED [ 88%]
tests/test_rvol.py::TestRVOLEdgeCases::test_future_date PASSED           [ 88%]
tests/test_rvol.py::TestRVOLEdgeCases::test_ticker_normalization PASSED  [ 89%]
tests/test_rvol.py::TestRVOLIntegration::test_realistic_workflow PASSED  [ 89%]
tests/test_sec_digester.py::test_classify_offering_and_contract PASSED   [ 89%]
tests/test_sec_digester.py::test_classify_ownership_and_dilution PASSED  [ 90%]
tests/test_sec_digester.py::test_aggregate_sentiment_tie_break PASSED    [ 90%]
tests/test_sec_digester.py::test_aggregate_sentiment_majority PASSED     [ 90%]
tests/test_sector_context.py::TestSectorLookup::test_get_ticker_sector_info_success PASSED [ 90%]
tests/test_sector_context.py::TestSectorLookup::test_get_ticker_sector_info_no_data PASSED [ 91%]
tests/test_sector_context.py::TestSectorLookup::test_get_ticker_sector_info_empty_ticker PASSED [ 91%]
tests/test_sector_context.py::TestSectorPerformance::test_get_sector_performance_success PASSED [ 91%]
tests/test_sector_context.py::TestSectorPerformance::test_get_sector_performance_calculations PASSED [ 91%]
tests/test_sector_context.py::TestSectorPerformance::test_get_sector_performance_vs_spy PASSED [ 92%]
tests/test_sector_context.py::TestSectorPerformance::test_get_sector_performance_no_etf_mapping PASSED [ 92%]
tests/test_sector_context.py::TestCaching::test_memory_cache_hit PASSED  [ 92%]
tests/test_sector_context.py::TestCaching::test_disk_cache_persistence PASSED [ 93%]
tests/test_sector_context.py::TestCaching::test_cache_ttl_expiration PASSED [ 93%]
tests/test_sector_context.py::TestBulkOperations::test_get_bulk_sector_info PASSED [ 93%]
tests/test_sector_context.py::TestBulkOperations::test_bulk_uses_cache PASSED [ 93%]
tests/test_sector_context.py::TestETFMapping::test_sector_etf_map_coverage PASSED [ 94%]
tests/test_sector_context.py::TestETFMapping::test_sector_name_aliases PASSED [ 94%]
tests/test_sector_context.py::TestConvenienceFunctions::test_get_ticker_sector PASSED [ 94%]
tests/test_sector_context.py::TestConvenienceFunctions::test_get_sector_metrics PASSED [ 95%]
tests/test_sector_context.py::TestConvenienceFunctions::test_get_sector_manager_singleton PASSED [ 95%]
tests/test_sector_context.py::TestEdgeCases::test_yfinance_api_error PASSED [ 95%]
tests/test_sector_context.py::TestEdgeCases::test_empty_historical_data PASSED [ 95%]
tests/test_sector_context.py::TestEdgeCases::test_insufficient_historical_data PASSED [ 96%]
tests/test_sector_context.py::TestEdgeCases::test_case_insensitivity PASSED [ 96%]
tests/test_sector_context.py::TestIntegrationWithBootstrapper::test_rejection_time_context PASSED [ 96%]
tests/test_sector_context.py::TestIntegrationWithBootstrapper::test_batch_processing_pattern PASSED [ 96%]
tests/test_sector_context.py::test_sector_context_module_imports PASSED  [ 97%]
tests/test_seen_store.py::test_seen_store_mark_and_query_roundtrip PASSED [ 97%]
tests/test_seen_store.py::test_should_filter_with_env_flag_off PASSED    [ 97%]
tests/test_seen_store.py::test_ttl_cleanup PASSED                        [ 98%]
tests/test_sentiment_sources.py::test_combined_sentiment_weighting PASSED [ 98%]
tests/test_sentiment_sources.py::test_combined_sentiment_gating PASSED   [ 98%]
tests/test_ticker_resolver.py::test_try_from_title_basic_patterns PASSED [ 98%]
tests/test_ticker_resolver.py::test_resolve_from_source_title_win PASSED [ 99%]
tests/test_ticker_resolver.py::test_resolve_from_source_none PASSED      [ 99%]
tests/test_tradesim.py::test_simulate_trades_returns_empty_for_missing_ticker PASSED [ 99%]
tests/test_watchlist_screener_boost.py::test_screener_boost_bypasses_price_ceiling FAILED [100%]

================================== FAILURES ===================================
C:\Users\menza\OneDrive\Desktop\Catalyst-Bot\catalyst-bot\tests\test_historical_bootstrapper.py:290: AssertionError: assert '15m' not in ['15m', '30m', '1h', '4h', '1d', '7d']
C:\Python313\Lib\json\decoder.py:363: json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
C:\Users\menza\AppData\Roaming\Python\Python313\site-packages\_pytest\python.py:147: Failed: async def functions are not natively supported.
C:\Users\menza\AppData\Roaming\Python\Python313\site-packages\_pytest\python.py:147: Failed: async def functions are not natively supported.
C:\Users\menza\AppData\Roaming\Python\Python313\site-packages\_pytest\python.py:147: Failed: async def functions are not natively supported.
C:\Users\menza\AppData\Roaming\Python\Python313\site-packages\_pytest\python.py:147: Failed: async def functions are not natively supported.
C:\Users\menza\AppData\Roaming\Python\Python313\site-packages\_pytest\python.py:147: Failed: async def functions are not natively supported.
C:\Users\menza\OneDrive\Desktop\Catalyst-Bot\catalyst-bot\tests\test_watchlist_screener_boost.py:109: AssertionError: assert 1 == 2
============================== warnings summary ===============================
tests\test_llm_stability.py:27
  C:\Users\menza\OneDrive\Desktop\Catalyst-Bot\catalyst-bot\tests\test_llm_stability.py:27: PytestUnknownMarkWarning: Unknown pytest.mark.anyio - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    pytestmark = pytest.mark.anyio

tests/test_admin_controls.py::TestIntegration::test_backtest_with_price_data
  C:\Users\menza\AppData\Roaming\Python\Python313\site-packages\numpy\_core\_methods.py:222: RuntimeWarning: Degrees of freedom <= 0 for slice
    ret = _var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,

tests/test_admin_controls.py::TestIntegration::test_backtest_with_price_data
  C:\Users\menza\AppData\Roaming\Python\Python313\site-packages\numpy\_core\_methods.py:214: RuntimeWarning: invalid value encountered in scalar divide
    ret = ret.dtype.type(ret / rcount)

tests/test_classify.py::test_classify_detects_fda_keyword_and_sentiment
  C:\Users\menza\OneDrive\Desktop\Catalyst-Bot\catalyst-bot\tests\test_classify.py:12: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ts_utc=datetime.utcnow(),

tests/test_historical_bootstrapper.py::TestEndToEnd::test_run_full_month
  C:\Users\menza\OneDrive\Desktop\Catalyst-Bot\catalyst-bot\src\catalyst_bot\historical_bootstrapper.py:1061: FutureWarning: YF.download() has changed argument auto_adjust default to True
    data = yf.download(

tests/test_tradesim.py::test_simulate_trades_returns_empty_for_missing_ticker
  C:\Users\menza\OneDrive\Desktop\Catalyst-Bot\catalyst-bot\tests\test_tradesim.py:12: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    ts_utc=datetime.utcnow(),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_historical_bootstrapper.py::TestSmartTimeframeSelection::test_get_available_timeframes_old
FAILED tests/test_historical_bootstrapper.py::TestOutcomeDataIntegration::test_fetch_and_log_outcomes_includes_all_enhancements
FAILED tests/test_llm_stability.py::TestRateLimiter::test_rate_limiter_wait_if_needed
FAILED tests/test_llm_stability.py::TestBatchProcessor::test_batch_processor_processes_in_batches
FAILED tests/test_llm_stability.py::TestBatchProcessor::test_batch_processor_handles_errors_gracefully
FAILED tests/test_llm_stability.py::TestIntegration::test_batch_processing_with_rate_limiting
FAILED tests/test_llm_stability.py::TestIntegration::test_batch_processing_with_error_recovery
FAILED tests/test_watchlist_screener_boost.py::test_screener_boost_bypasses_price_ceiling
================= 8 failed, 353 passed, 6 warnings in 43.17s ==================
